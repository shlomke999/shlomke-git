1. לזהות c2 attack - ניטור dns/http/icmp traffic ולזהות אם יש "התנהגות" c2 מהוסט מסויים (המון פאקטות למשל), גודל חריג של פאקטות ועוד.

2. לזהות mitm - התראה אם יש latency, או שיש המון arp response בזמן קצר מאותו אייפי,או ששני mac שונים ממופים לאותו ip (או שימוש בכלי XArp)
איך למנוע? סטטיק arp, שימוש ב https וב vpn, סגמנטציה לרשת.

3. לזהות הרעלת LLMNR - תקיפת mitm שתוקף מאזין לבקשת llmnr ששואלת בברודקאסט מה האייפי של משאב משותף מסויים (לא תקין, ןלכן הדנס לא מצא לו תשובה) ומחזיר לה תשובה שזה הוא. (בד"כ ע"י responder), ואז הנתקף שולח לו את ההאש כדי לגשת לאותו משאב משותף, ןאז התוקף שולח לו איזו שגיאה. עם ההאש התוקף יוכל לגשת לאותו משאב או לגלות את הסיסמא שממנה נוצר ההאש.
הדרך לזהות: שימוש סקדיואלי בסקריפט ששולח בקשת dns על הוסט שלא קיים, ואם יש תשובה מ llmnr סימן שיש תוקף וזה התוקף שענה, להעביר את הלוג עם התשובות ל siem עם התראה על כל איבנט שיהיה שם.
הדרך למנוע: network access control, segmentation, וכמובן הדרך לחסום לגמרי זה לבטל llmnr.

4. לזהות NTLM relay(new technology lan manager) - פרוטוקול אימות, השרת שולח צ'אלנג' לקליינט להצפין 16 תוים מסויימים ביחד עם ההאש של הסיסמא שלו, הקליינט שולח את זה לשרת והוא מאמת.
התקיפה היא להיות mitm בין הקליינט לשרת וכך בסוף יש לך את הצ'אלנג' ואתה יכול להזדהות איתו בשרת הזה או באחרים.
מייקרוסופט פיתחו כמה הגנות (להפעיל smb signing, ldap signing)  אבל אפשר לעקוף.
הדרך לזהות: לעשות חוק שמתעד איבנט 4624 של  NTLM לוגין, לבדוק אם יש התחברות משני מאקים עם אותו האש. או עם אותו האש פעמיים בזמן קצר.
הדרך למנוע: שימוש בקרברוס שהוא הפרוטוקול אימות שהחליף את NTLM


SMB- RELAY
כשתוקף משיג NTLM HASH ומעביר למכונה אחרת ברשת תוך התחזות למשתמש מאומת.
מיטיגציה: smb signing, עושה HASH לכל הודעה ואז מצפינים את הHASH עם הPRIVATE KEY ואז היעד שמפענח עם הPUBLIC KEY מקבל את הHASH של ההודעה ויכול לוודא שתואם להודעה שקיבל.
החתימה מאמתת שכל הודעה שמגיעה ליעד הגיעה מהמקור, כל שינוי שנעשה ייחתם וכך יהיה אפשר לוודא אינטגריטי (שלא נשלחה ממישהו שהשיג גישה לHASHED CHALLNGE אך לא מחזיקה בPRIVATE KEY.
לזהות - כשמשתמש לא מורשה ניגש לרכיב רגיש (למשל עם ווייטליסט, ינוטר בלוגים של אותו רכיב).
למנוע - קרברוס. 

6. זיהוי ddos - יש רכיבים כמו ndr שיזהו אוטומאטית, ואפשר בסים להגדיר התרעה על מספר פאקטות גדול מהממוצע מאותה כתובת אייפי בזמן קצר.
כשנזהה מתקפה כזו נחסום את הכתובות שמשתתפות בתקיפה.

7. תמיד לוודא שהפיירוול חוסם פורטים של שיתוף קבצים.
  
  find open process pid:
sudo ss -lptn 'sport = :8001'   
